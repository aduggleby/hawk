@page
@model Hawk.Web.Areas.Identity.Pages.Account.Manage.SettingsModel
@{
    ViewData["Title"] = "Alerts & Crawler";
}

<div class="mb-4">
    <div class="text-xs font-mono uppercase tracking-tight text-zinc-500">Account settings</div>
    <h2 class="text-2xl font-semibold tracking-tight">Alerts, crawler, and retention</h2>
    <p class="text-sm text-zinc-600 mt-1">Configure defaults for monitors you own. Leave a field empty to use fallback behavior.</p>
</div>

<form method="post" class="space-y-4">
    <div class="rounded-xl border border-[color:var(--border-primary)] bg-[color:var(--bg-secondary)] overflow-hidden">
        <div class="px-4 py-3 border-b border-[color:var(--border-primary)]">
            <div class="font-semibold">Alert recipient</div>
            <div class="text-sm text-zinc-600 mt-1">
                Resolution order: monitor override → account override → login email.
            </div>
        </div>
        <div class="p-4">
            <div>
                <label class="hawk-label" asp-for="AlertEmail"></label>
                <input class="hawk-input mt-2 font-mono" asp-for="AlertEmail" placeholder="alerts@yourdomain" />
                <div class="hawk-error-message" asp-validation-for="AlertEmail"></div>
            </div>
        </div>
    </div>

    <div class="rounded-xl border border-[color:var(--border-primary)] bg-[color:var(--bg-secondary)] overflow-hidden">
        <div class="px-4 py-3 border-b border-[color:var(--border-primary)]">
            <div class="font-semibold">Crawler User-Agent</div>
            <div class="text-sm text-zinc-600 mt-1">
                Used for monitors you own unless that monitor defines its own User-Agent header.
                If empty, Hawk uses server default: <span class="font-mono">@Model.ServerDefaultUserAgent</span>.
            </div>
        </div>
        <div class="p-4 space-y-3">
            <div>
                <label class="hawk-label" asp-for="UserAgent"></label>
                <input class="hawk-input mt-2 font-mono" asp-for="UserAgent" placeholder="firefox (or full UA string)" />
                <div class="hawk-error-message" asp-validation-for="UserAgent"></div>
            </div>
            <div class="text-xs text-zinc-500">
                Presets:
                @for (var i = 0; i < Model.PresetKeys.Count; i++)
                {
                    <span class="font-mono">@Model.PresetKeys[i]</span>@(i < Model.PresetKeys.Count - 1 ? "," : "")
                    <text> </text>
                }
            </div>
        </div>
    </div>

    <div class="rounded-xl border border-[color:var(--border-primary)] bg-[color:var(--bg-secondary)] overflow-hidden">
        <div class="px-4 py-3 border-b border-[color:var(--border-primary)]">
            <div class="font-semibold">Run retention</div>
            <div class="text-sm text-zinc-600 mt-1">
                Account-wide default retention for your monitor run history.
                Per-monitor override takes precedence. If empty, default is 90 days.
            </div>
        </div>
        <div class="p-4">
            <div>
                <label class="hawk-label" asp-for="RunRetentionDays"></label>
                <input class="hawk-input mt-2" asp-for="RunRetentionDays" type="number" min="1" max="3650" placeholder="90" />
                <div class="hawk-error-message" asp-validation-for="RunRetentionDays"></div>
            </div>
        </div>
    </div>

    <div class="flex items-center justify-between gap-3 pt-1">
        <div class="text-xs text-zinc-500">One save updates all sections on this page.</div>
        <div class="flex items-center gap-2">
            <button class="hawk-btn hawk-btn-primary" type="submit">Save settings</button>
            <a class="hawk-btn hawk-btn-ghost" asp-page="/Monitors/Index">Back to monitors</a>
        </div>
    </div>
</form>

@section Scripts {
    <partial name="/Areas/Identity/Pages/Shared/_ValidationScriptsPartial.cshtml" />
}
