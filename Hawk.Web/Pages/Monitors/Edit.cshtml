@page "{id:guid}"
@* <summary>Edit monitor.</summary> *@
@model Hawk.Web.Pages.Monitors.EditModel
@{
    ViewData["Title"] = "Edit monitor";
}

<div class="flex items-start justify-between gap-4 mb-6">
    <div>
        <h1 class="text-2xl font-semibold tracking-tight">Edit monitor</h1>
        <p class="text-sm text-zinc-600">Update schedule, request, and match rules.</p>
    </div>
    <div class="flex items-center gap-2">
        <a class="hawk-btn-ghost" asp-page="/Monitors/Details" asp-route-id="@Model.Id">Back</a>
        <a class="hawk-btn-danger" asp-page="/Monitors/Delete" asp-route-id="@Model.Id">Delete</a>
    </div>
</div>

<form method="post" class="space-y-4">
    <div class="hawk-card">
        <label class="hawk-label" asp-for="Form.Name"></label>
        <input class="hawk-input mt-2" asp-for="Form.Name" />
        <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.Name"></div>
    </div>

    <div class="hawk-card">
        <label class="hawk-label" asp-for="Form.Url"></label>
        <input class="hawk-input mt-2 font-mono" asp-for="Form.Url" />
        <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.Url"></div>
    </div>

    <div class="hawk-card">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
            <div>
                <label class="hawk-label" asp-for="Form.Method"></label>
                <select class="hawk-select mt-2" asp-for="Form.Method">
                    <option value="GET">GET</option>
                    <option value="POST">POST</option>
                </select>
                <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.Method"></div>
            </div>
            <div>
                <label class="hawk-label" asp-for="Form.IntervalSeconds"></label>
                <select class="hawk-select mt-2" asp-for="Form.IntervalSeconds">
                    @foreach (var s in Model.AllowedIntervals)
                    {
                        <option value="@s">@((s < 60) ? $"{s}s" : $"{s/60}m")</option>
                    }
                </select>
                <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.IntervalSeconds"></div>
            </div>
            <div>
                <label class="hawk-label" asp-for="Form.TimeoutSeconds"></label>
                <input class="hawk-input mt-2" asp-for="Form.TimeoutSeconds" type="number" min="1" max="300" />
                <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.TimeoutSeconds"></div>
            </div>
            <div class="flex items-end">
                <label class="inline-flex items-center gap-2 text-sm">
                    <input class="h-4 w-4" asp-for="Form.Enabled" />
                    <span class="font-medium">@Html.DisplayNameFor(m => m.Form.Enabled)</span>
                </label>
            </div>
        </div>
    </div>

    <div class="hawk-card">
        <div class="font-semibold mb-2">POST options</div>
        <div class="mt-4">
            <label class="hawk-label" asp-for="Form.ContentType"></label>
            <input class="hawk-input mt-2 font-mono" asp-for="Form.ContentType" />
            <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.ContentType"></div>
        </div>
        <div class="mt-4">
            <label class="hawk-label" asp-for="Form.Body"></label>
            <textarea class="hawk-input mt-2 font-mono" asp-for="Form.Body" rows="6"></textarea>
            <div class="text-sm text-red-700 mt-1" asp-validation-for="Form.Body"></div>
        </div>
    </div>

    <div class="hawk-card">
        <div class="font-semibold mb-2">Headers</div>
        @for (var i = 0; i < 5; i++)
        {
            <div class="grid grid-cols-1 md:grid-cols-12 gap-2 mb-2">
                <div class="md:col-span-4">
                    <input class="hawk-input font-mono" name="Form.HeaderNames[@i]" value="@Model.Form.HeaderNames[i]" />
                </div>
                <div class="md:col-span-8">
                    <input class="hawk-input font-mono" name="Form.HeaderValues[@i]" value="@Model.Form.HeaderValues[i]" />
                </div>
            </div>
        }
    </div>

    <div class="hawk-card">
        <div class="font-semibold mb-2">Match rules</div>
        @for (var i = 0; i < 5; i++)
        {
            <div class="grid grid-cols-1 md:grid-cols-12 gap-2 mb-2">
                <div class="md:col-span-3">
                    <select class="hawk-select" name="Form.MatchModes[@i]">
                        <option value="None" selected="@(Model.Form.MatchModes[i] == Hawk.Web.Services.ContentMatchMode.None)">None</option>
                        <option value="Contains" selected="@(Model.Form.MatchModes[i] == Hawk.Web.Services.ContentMatchMode.Contains)">Contains</option>
                        <option value="Regex" selected="@(Model.Form.MatchModes[i] == Hawk.Web.Services.ContentMatchMode.Regex)">Regex</option>
                    </select>
                </div>
                <div class="md:col-span-9">
                    <input class="hawk-input font-mono" name="Form.MatchPatterns[@i]" value="@Model.Form.MatchPatterns[i]" />
                </div>
            </div>
        }
    </div>

    <div class="flex items-center gap-2">
        <button class="hawk-btn-primary" type="submit">Save</button>
        <a class="hawk-btn-ghost" asp-page="/Monitors/Details" asp-route-id="@Model.Id">Cancel</a>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
